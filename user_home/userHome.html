<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>My Account - UTRGV Lost & Found</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="login-background">

<nav class="navbar navbar-dark bg-dark mb-4 utrgv-navbar">
    <div class="container d-flex flex-column align-items-center">
        <h1 class="navbar-title"><span class="utr-orange">UTRGV</span> Lost &amp; Found</h1>
        <div class="navbar-actions mt-2">
            <div class="navbar-actions mt-2">
    <a href="../AfterLogIn/afterLog.html" class="btn btn-outline-light btn-sm">Back to Home</a>
    <button onclick="logout()" class="btn btn-outline-light btn-sm">Logout</button>
</div>
    </div>
</nav>

<div class="container text-center">
    <div class="profile-pic mx-auto mb-3"><span>+</span></div>
    <h3 id="userName"></h3>
    <p id="userID"></p>
    <p id="userEmail"></p>

    <div class="row mt-4">
        <div class="col-md-6">
            <div class="card shadow-sm p-3 mb-4">
                <h5 class="fw-bold">My Lost Items</h5>
                <ul id="lostItemsList" class="list-group list-group-flush"></ul>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card shadow-sm p-3 mb-4">
                <h5 class="fw-bold">Your Found Items</h5>
                <ul id="foundItemsList" class="list-group list-group-flush"></ul>
            </div>
        </div>
    </div>
</div>

<script>
const currentUser = JSON.parse(localStorage.getItem("currentUser"));
const lostList = document.getElementById("lostItemsList");
const foundList = document.getElementById("foundItemsList");

if (!currentUser) {
    alert("You must be logged in to view this page.");
    window.location.href = "../login/account creation/login.html";
}

document.getElementById("userName").innerText = currentUser.name;
document.getElementById("userEmail").innerText = currentUser.email;
document.getElementById("userID").innerText = currentUser.id;

// Helper to format 24-hour time to 12-hour format
function formatTime(time24) {
    if (!time24) return "";
    const [hourStr, min] = time24.split(":");
    let hour = parseInt(hourStr);
    const ampm = hour >= 12 ? "PM" : "AM";
    hour = hour % 12;
    if (hour === 0) hour = 12;
    return `${hour}:${min} ${ampm}`;
}

// Get user items
const allItems = JSON.parse(localStorage.getItem("userItems")) || {};
const userItems = allItems[currentUser.email] || { lost: [], found: [] };

// Populate lost items
userItems.lost.forEach(item => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.textContent = `${item.color} ${item.type} in ${item.building}, Room ${item.room} — ${item.date} at ${formatTime(item.time)}`;
    lostList.appendChild(li);
});

// Populate found items
userItems.found.forEach(item => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.textContent = `${item.color} ${item.type} in ${item.building}, Room ${item.room} — ${item.date} at ${formatTime(item.time)}`;
    foundList.appendChild(li);
});

function logout() {
    localStorage.removeItem("currentUser");
    window.location.href = "../home/index.html";
}
</script>



</body>
</html>
