<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Account - UTRGV Lost & Found</title>
  <link rel="stylesheet" href="../style.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="login-background">

<nav class="navbar navbar-dark bg-dark mb-4 utrgv-navbar">
  <div class="container d-flex flex-column align-items-center">
    <h1 class="navbar-title">
      <span class="utr-orange">UTRGV</span> Lost &amp; Found
    </h1>
    <div class="navbar-actions mt-2">
      <a href="../AfterLogIn/afterLog.html" class="btn btn-outline-light btn-sm">Home</a>
    </div>
  </div>
</nav>

<div class="container text-center">
  <div class="profile-pic mx-auto mb-3" id="profilePic">
    <span id="profilePlus">+</span>
</div>

<input
    type="file"
    id="profileUpload"
    accept="image/*"
    hidden
>


  <h3 id="userName"></h3>
  <p id="userID"></p>
  <p id="userEmail"></p>

  <div class="row mt-4">

    <!-- Lost Items -->
    <div class="col-md-6">
      <div class="card shadow-sm p-3 mb-4 text-start">
        <h5 class="fw-bold">Lost Items</h5>
        <p class="text-muted">Items you reported as lost.</p>
        <ul id="myLostItemsList" class="list-group list-group-flush"></ul>
      </div>
    </div>

    <!-- Found Items -->
    <div class="col-md-6">
      <div class="card shadow-sm p-3 mb-4 text-start">
        <h5 class="fw-bold">Found Items</h5>
        <p class="text-muted">Items you reported as found.</p>
        <ul id="myFoundItemsList" class="list-group list-group-flush"></ul>
      </div>
    </div>

  </div>
</div>

<script src="userHome.js"></script>
<script>
const user = JSON.parse(localStorage.getItem("userInfo"));

if (!user || !user.email) {
    alert("Please log in first.");
    window.location.href = "../login/account creation/login.html";
}

const profilePic = document.getElementById("profilePic");
const profileUpload = document.getElementById("profileUpload");

// Load saved profile photo
const savedPhotos = JSON.parse(localStorage.getItem("profilePhotos")) || {};

if (savedPhotos[user.email]) {
    profilePic.innerHTML = `<img src="${savedPhotos[user.email]}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
}

// Click profile circle â†’ open file picker
profilePic.addEventListener("click", () => {
    profileUpload.click();
});

// When user selects image
profileUpload.addEventListener("change", function () {
    const file = this.files[0];
    if (!file) return;

    const reader = new FileReader();

    reader.onload = function () {
        const imgData = reader.result;

        // Save per user
        savedPhotos[user.email] = imgData;
        localStorage.setItem("profilePhotos", JSON.stringify(savedPhotos));

        // Show image
        profilePic.innerHTML = `<img src="${imgData}" style="width:100%; height:100%; border-radius:50%; object-fit:cover;">`;
    };

    reader.readAsDataURL(file);
});
</script>


</body>
</html>